{% extends 'base.html' %}

{% block ng_app %}mainApp{% endblock %}

{% block title %}WriteToGov - Write Your Elected Representatives{% endblock %}

{% block content %}
<ng-include src="'navbar-template'"></ng-include>
<ng-view></ng-view>
<ng-include src="'footer-template'"></ng-include>
{% endblock %}

{% block extra_scripts %}
<script type="text/ng-template" id="navbar-template">
  <md-toolbar class="header-toolbar">
    <div layout="row" flex>
      <div flex="70">
        <a href="/" class="header-link">
          <img src="/static/img/logo-white.svg" class="header-logo"/>
          Write to the Government
        </a>
      </div>
    </div>
  </md-toolbar>
</script>

<script type="text/ng-template" id="footer-template">
  <md-toolbar class="footer-toolbar">
    &copy; 2016 writetogov.com
  </md-toolbar>
</script>

<script type="text/ng-template" id="index-template">
  <div ng-controller="IndexCtrl">
    <div class="container index-search-container">
      <div class="tagline-1">
        In this digital age, do something old-fashioned:
      </div>
      <div class="tagline-2">
        Write and mail a letter to your elected representatives.
      </div>

      <div class="search-panel">
        <div ng-show="state.searchMode == SearchMode.ADDRESS && !state.loading">
          <div>Enter your address to look up your representatives</div>

          <div class="address-input-wrapper">
            <input type="text" ng-model="form.address"
              class="address-input" placeholder="Address"
              google-place-autocomplete on-select="placeSelected($place)"
              autofocus/>
          </div>

          <div class="search-toggle">
            <a href="javascript:void(0)" ng-click="setSearchMode(SearchMode.TEXT)"
              md-colors="{color:'primary'}" class="search-toggle-link">
              Or search by representative name, state, or district
            </a>
          </div>
        </div>

        <div ng-show="state.searchMode == SearchMode.TEXT && !state.loading">
          <div>Search by representative name, state name, or district</div>
          <md-autocomplete
            md-selected-item="form.selectedSearchItem"
            md-search-text="form.searchText"
            md-items="item in textSearch(form.searchText)"
            md-item-text="item.name"
            md-min-length="0"
            placeholder="e.g. 'nancy pelosi', 'california', 'ca 12th'">
            <md-item-template>
              <span md-highlight-text="form.searchText" md-highlight-flags="i">
                [[item.name]] - [[item.stateName]] [[item.title]] [[item.districtOrdinal ? ' - ' + item.districtOrdinal + ' district' : '']]
              </span>
            </md-item-template>
          </md-autocomplete>
          <div class="search-toggle">
            <a href="javascript:void(0)" ng-click="setSearchMode(SearchMode.ADDRESS)"
              md-colors="{color:'primary'}" class="search-toggle-link">
              Or search by address
            </a>
          </div>
        </div>
      </div>

      <md-progress-circular md-mode="indeterminate" ng-show="state.loading" class="center-progress">
      </md-progress-circular>
    </div>
    <div class="container index-desc-container">
      <div class="center-text">
        <p>
          Change is more likely to come for groups that are vocal. Our representatives
          are tasked with listening to us and acting on our behalf but due to busyness,
          complacency, and other factors too many of us don't reach out to our elected
          officials.
        </p>
        <p>
          If you have the passion to reach out to your representatives about an issue,
          this tool can help make the process of contacting them as easy as possible.
        </p>
      </div>
    </div>
    <div class="container index-how-it-works-container">
      <div class="headline">How it Works</div>
      <div class="center-text">
        <p>
          Start by looking up who represents you. Enter your address to see the House
          representative from your district and your two senators, as well as the
          House and Senate leadership.
        </p>
        <p>
          writetogov.com maintains a list of all representatives and their contact
          information at their Washington DC office. (We are currently compiling a list
          of contact info for local district offices and would love your help.)
        </p>
        <p>
          You can then compose a brief letter here on the site, then merely click a
          button to generate a properly-headed and addressed PDF which you can then
          print and mail. Alternatively for maximum simplicity, for a small fee to
          cover costs, we will print and send the letter for you, using lob.com.
        </p>
      </div>
    </div>
    <div class="container index-reminder-container" ng-controller="ReminderCtrl">
      <div class="headline">
        Maximize your impact by contacting your representatives regularly
      </div>
      <div class="reminder-form-panel">
        <p>
          Sign up to get a periodic reminder to write another letter:
        </p>
        <div class="md-inline-form reminder-form" layout="column">
          <div layout="row" flex layout-align="center start">
            <md-input-container flex="70" class="md-block hide-error-msg hack-email-alignment">
              <label>Email</label>
              <input type="text" ng-model="form.email"/>
            </md-input-container>
            <md-input-container flex="30" class="md-block">
              <label>Frequency</label>
              <md-select ng-model="form.frequency">
                <md-option value="[[Frequency.WEEKLY]]">
                  Weekly
                </md-option>
                <md-option value="[[Frequency.MONTHLY]]">
                  Monthly
                </md-option>
              </md-select>
            </md-input-container>
          </div>
          <div class="submit-button">
            <md-button class="md-primary md-raised">Submit</md-button>
          </div>
        </div>
      </div>
    </div>
  </div>
</script>

<script type="text/ng-template" id="district-template">
  <div class="container district-container" ng-controller="DistrictCtrl">
    <md-progress-circular md-mode="indeterminate" ng-show="state.loading" class="center-progress">
    </md-progress-circular>
    <div ng-if="!state.loading">
      <h1 class="district-header">Your Representatives</h1>
      <div layout="row" layout-wrap layout-align="center none">
        <rep-card rep="repResults.houseRep"></rep-card>
        <rep-card ng-repeat="rep in repResults.senators" rep="rep"></rep-card>
      </div>
      <h2 class="leadership-header">
        Consider also writing to congressional leadership:
      </h2>
      <div layout="row" layout-wrap layout-align="center none">
        <rep-card ng-if="repResults.houseSpeaker" rep="repResults.houseSpeaker"
          extra-title="Speaker of the House">
        </rep-card>
        <rep-card ng-if="repResults.senateMajorityLeader" rep="repResults.senateMajorityLeader"
          extra-title="Senate Majority Leader">
        </rep-card>
      </div>
    </div>
  </div>
</script>

<script type="text/ng-template" id="rep-page-template">
  <div class="container district-container" ng-controller="RepPageCtrl">
    <md-progress-circular md-mode="indeterminate" ng-show="state.loading" class="center-progress">
    </md-progress-circular>
    <div ng-if="!state.loading">
      <div layout="row" layout-wrap layout-align="center none">
        <rep-card rep="rep"></rep-card>
      </div>
    </div>
  </div>
</script>

<script type="text/ng-template" id="rep-card-template">
  <md-card class="rep-card">
    <md-card-title>
      <md-card-title-text>
        <span class="md-headline">
          <span ng-if="rep['status'] == RepStatus.VACANT">(Vacant)</span>
          <span ng-if="rep['status'] != RepStatus.VACANT">[[rep['first_name'] ]] [[rep['last_name'] ]]</span>
        </span>
        <span ng-if="extraTitle" md-colors="{color:'accent'}">[[extraTitle]]</span>
        <span class="md-subhead">
          [[rep['title'] ]] - [[rep['state_name'] ]]
          <span ng-if="rep['chamber'] == 'HOUSE'">[[rep['district_ordinal'] ]] District</span>
        </span>
        <span ng-if="statusMessage" md-colors="{color:'warn'}">[[statusMessage]]</span>
      </md-card-title-text>
      <md-card-title-media>
        <div class="md-media-md card-media">
          <img ng-src="[[rep['photo_url'] ]]" class="rep-photo"/>
        </div>
      </md-card-title-media>
    </md-card-title>
    <md-card-content>
      <div ng-repeat="line in rep['address_dc_lines']">
        [[line]]
      </div>
      <div class="phone">
        <a ng-href="tel:[[rep['phone_dc'] ]]" md-colors="{color:'primary'}">[[rep['phone_dc'] ]]</a>
      </div>
    </md-card-content>
    <md-card-actions layout="row" layout-align="end center">
      <md-button class="md-primary md-raised">Write a Letter</md-button>
    </md-card-actions>
  </md-card>
</script>

<script src="https://maps.googleapis.com/maps/api/js?libraries=places"></script>

<script>
  initMain({{client_config | tojson}});
</script>
{% endblock %}
